<div class="row justify-content-center">
    <div class="col-lg-6 text-center">
        <div class="error-icon mb-4">
            <i class="bi bi-exclamation-triangle-fill text-danger"></i>
        </div>
        <h2 class="mb-3">Oops! Something went wrong</h2>
        <p class="lead text-muted mb-4">
            <%= message || 'An unexpected error occurred. Please try again later.' %>
        </p>

        <% if (locals.error && error.status) { %>
        <div class="alert alert-danger d-inline-block mb-4">
            <strong>Error <%= error.status %></strong>
            <% if (error.code) { %>
                <span class="ms-2 text-muted">(<%= error.code %>)</span>
            <% } %>
        </div>
        <% } %>

        <div class="d-flex gap-2 justify-content-center">
            <a href="/" class="btn btn-primary">
                <i class="bi bi-house me-2"></i>Go Home
            </a>
            <button onclick="history.back()" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left me-2"></i>Go Back
            </button>
        </div>

        <!-- Additional Help -->
        <div class="mt-5 pt-4 border-top">
            <h5 class="mb-3">Need Help?</h5>
            <div class="row g-3">
                <div class="col-md-4">
                    <div class="card border-0 bg-light h-100">
                        <div class="card-body text-center">
                            <i class="bi bi-book text-primary fs-3 mb-2"></i>
                            <h6 class="card-title">Documentation</h6>
                            <a href="/api/docs" class="stretched-link text-decoration-none small" target="_blank">
                                View API Docs
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card border-0 bg-light h-100">
                        <div class="card-body text-center">
                            <i class="bi bi-heart-pulse text-success fs-3 mb-2"></i>
                            <h6 class="card-title">System Status</h6>
                            <a href="/api/health" class="stretched-link text-decoration-none small" target="_blank">
                                Check Health
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card border-0 bg-light h-100">
                        <div class="card-body text-center">
                            <i class="bi bi-folder text-warning fs-3 mb-2"></i>
                            <h6 class="card-title">My Pages</h6>
                            <a href="/editor" class="stretched-link text-decoration-none small">
                                Go to Editor
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Error Details (Development Only) -->
        <% if (locals.error && process.env.NODE_ENV === 'development' && error.stack) { %>
        <div class="mt-5 text-start">
            <details class="border rounded p-3">
                <summary class="cursor-pointer user-select-none fw-bold">
                    <i class="bi bi-bug me-2"></i>Error Details (Development Only)
                </summary>
                <div class="mt-3">
                    <pre class="bg-dark text-light p-3 rounded small" style="max-height: 400px; overflow: auto;"><%= error.stack %></pre>
                </div>
            </details>
        </div>
        <% } %>
    </div>
</div>

<style>
    .error-icon {
        font-size: 6rem;
        opacity: 0.8;
        animation: shake 0.5s ease-in-out;
    }

    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-10px); }
        75% { transform: translateX(10px); }
    }

    .card-body .stretched-link:hover {
        text-decoration: underline !important;
    }

    details summary {
        cursor: pointer;
        user-select: none;
    }

    details summary::-webkit-details-marker {
        display: none;
    }

    details[open] summary::before {
        content: '▼ ';
    }

    details:not([open]) summary::before {
        content: '▶ ';
    }

    /* Dark mode adjustments */
    [data-bs-theme="dark"] .card.bg-light {
        background: var(--bs-gray-800) !important;
    }

    [data-bs-theme="dark"] .card.bg-light .card-body {
        color: var(--bs-gray-300);
    }
</style>
