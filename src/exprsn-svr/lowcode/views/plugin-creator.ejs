<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %> - Exprsn Low-Code</title>

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">

    <style>
        /* ================================================================
           EXPRSN DESIGN SYSTEM - PLUGIN CREATOR
           ================================================================ */

        :root {
            /* Colors - Light Theme */
            --exprsn-primary: #0066ff;
            --exprsn-secondary: #7c3aed;
            --exprsn-success: #10b981;
            --exprsn-danger: #ef4444;
            --exprsn-warning: #f59e0b;
            --exprsn-info: #3b82f6;

            /* Neutrals */
            --exprsn-bg-primary: #ffffff;
            --exprsn-bg-secondary: #f9fafb;
            --exprsn-bg-tertiary: #f3f4f6;
            --exprsn-text-primary: #171717;
            --exprsn-text-secondary: #737373;
            --exprsn-text-tertiary: #a3a3a3;
            --exprsn-border-color: #e5e7eb;
            --exprsn-surface-raised: #ffffff;

            /* Shadows */
            --exprsn-shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --exprsn-shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --exprsn-shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --exprsn-shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);

            /* Spacing */
            --exprsn-spacing-xs: 0.25rem;
            --exprsn-spacing-sm: 0.5rem;
            --exprsn-spacing-md: 1rem;
            --exprsn-spacing-lg: 1.5rem;
            --exprsn-spacing-xl: 2rem;

            /* Border Radius */
            --exprsn-radius-sm: 0.375rem;
            --exprsn-radius-md: 0.5rem;
            --exprsn-radius-lg: 0.75rem;
            --exprsn-radius-xl: 1rem;
            --exprsn-radius-full: 9999px;

            /* Typography */
            --exprsn-font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            --exprsn-font-family-mono: 'JetBrains Mono', 'Fira Code', monospace;

            /* Transitions */
            --exprsn-transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --exprsn-transition-base: 200ms cubic-bezier(0.4, 0, 0.2, 1);
            --exprsn-transition-slow: 300ms cubic-bezier(0.4, 0, 0.2, 1);

            /* Layout */
            --sidebar-width: 280px;
            --topbar-height: 64px;
        }

        /* Dark Theme */
        [data-theme="dark"] {
            --exprsn-bg-primary: #0a0a0a;
            --exprsn-bg-secondary: #171717;
            --exprsn-bg-tertiary: #262626;
            --exprsn-text-primary: #fafafa;
            --exprsn-text-secondary: #a3a3a3;
            --exprsn-text-tertiary: #737373;
            --exprsn-border-color: #404040;
            --exprsn-surface-raised: #171717;
            --exprsn-primary: #3b82f6;

            --exprsn-shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.3);
            --exprsn-shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.3), 0 2px 4px -2px rgb(0 0 0 / 0.3);
            --exprsn-shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3), 0 4px 6px -4px rgb(0 0 0 / 0.3);
            --exprsn-shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.3), 0 8px 10px -6px rgb(0 0 0 / 0.3);
        }

        /* ================================================================
           BASE STYLES
           ================================================================ */

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--exprsn-font-family);
            background: var(--exprsn-bg-secondary);
            color: var(--exprsn-text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* ================================================================
           LAYOUT
           ================================================================ */

        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--exprsn-surface-raised);
            border-right: 1px solid var(--exprsn-border-color);
            position: fixed;
            left: 0;
            top: 0;
            bottom: 0;
            overflow-y: auto;
            z-index: 100;
            transition: transform var(--exprsn-transition-base);
        }

        .sidebar-header {
            padding: var(--exprsn-spacing-lg);
            border-bottom: 1px solid var(--exprsn-border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .sidebar-brand {
            display: flex;
            align-items: center;
            gap: var(--exprsn-spacing-sm);
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--exprsn-primary);
            text-decoration: none;
        }

        .sidebar-content {
            padding: var(--exprsn-spacing-md);
        }

        .step-nav {
            display: flex;
            flex-direction: column;
            gap: var(--exprsn-spacing-sm);
        }

        .step-item {
            display: flex;
            align-items: center;
            gap: var(--exprsn-spacing-md);
            padding: var(--exprsn-spacing-md);
            border-radius: var(--exprsn-radius-lg);
            cursor: pointer;
            transition: all var(--exprsn-transition-fast);
            position: relative;
        }

        .step-item:hover {
            background: var(--exprsn-bg-tertiary);
        }

        .step-item.active {
            background: linear-gradient(135deg, rgba(0, 102, 255, 0.1), rgba(124, 58, 237, 0.1));
            border: 1px solid var(--exprsn-primary);
        }

        .step-item.completed {
            background: rgba(16, 185, 129, 0.1);
        }

        .step-number {
            width: 32px;
            height: 32px;
            border-radius: var(--exprsn-radius-full);
            background: var(--exprsn-bg-tertiary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.875rem;
            flex-shrink: 0;
        }

        .step-item.active .step-number {
            background: var(--exprsn-primary);
            color: white;
        }

        .step-item.completed .step-number {
            background: var(--exprsn-success);
            color: white;
        }

        .step-info {
            flex: 1;
        }

        .step-title {
            font-weight: 600;
            font-size: 0.9375rem;
            color: var(--exprsn-text-primary);
        }

        .step-description {
            font-size: 0.8125rem;
            color: var(--exprsn-text-secondary);
            margin-top: var(--exprsn-spacing-xs);
        }

        /* Main Content */
        .main-container {
            margin-left: var(--sidebar-width);
            flex: 1;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Top Bar */
        .topbar {
            height: var(--topbar-height);
            background: var(--exprsn-surface-raised);
            border-bottom: 1px solid var(--exprsn-border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 var(--exprsn-spacing-xl);
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .topbar-left {
            display: flex;
            align-items: center;
            gap: var(--exprsn-spacing-md);
        }

        .topbar-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--exprsn-text-primary);
        }

        .topbar-right {
            display: flex;
            align-items: center;
            gap: var(--exprsn-spacing-md);
        }

        .btn-theme {
            width: 40px;
            height: 40px;
            border-radius: var(--exprsn-radius-full);
            background: var(--exprsn-bg-tertiary);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--exprsn-transition-fast);
            color: var(--exprsn-text-primary);
        }

        .btn-theme:hover {
            background: var(--exprsn-border-color);
            transform: scale(1.05);
        }

        /* Content Area */
        .content-area {
            flex: 1;
            padding: var(--exprsn-spacing-xl);
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }

        .wizard-step {
            display: none;
            animation: fadeIn var(--exprsn-transition-base);
        }

        .wizard-step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .step-header {
            margin-bottom: var(--exprsn-spacing-xl);
        }

        .step-title-main {
            font-size: 2rem;
            font-weight: 700;
            color: var(--exprsn-text-primary);
            margin-bottom: var(--exprsn-spacing-sm);
        }

        .step-subtitle {
            font-size: 1.125rem;
            color: var(--exprsn-text-secondary);
        }

        /* Form Elements */
        .form-section {
            background: var(--exprsn-surface-raised);
            border-radius: var(--exprsn-radius-xl);
            padding: var(--exprsn-spacing-xl);
            margin-bottom: var(--exprsn-spacing-lg);
            border: 1px solid var(--exprsn-border-color);
        }

        .form-section-header {
            display: flex;
            align-items: center;
            gap: var(--exprsn-spacing-md);
            margin-bottom: var(--exprsn-spacing-lg);
            padding-bottom: var(--exprsn-spacing-md);
            border-bottom: 1px solid var(--exprsn-border-color);
        }

        .section-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--exprsn-radius-lg);
            background: linear-gradient(135deg, var(--exprsn-primary), var(--exprsn-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--exprsn-text-primary);
        }

        .form-group {
            margin-bottom: var(--exprsn-spacing-lg);
        }

        .form-label {
            display: block;
            font-weight: 500;
            color: var(--exprsn-text-primary);
            margin-bottom: var(--exprsn-spacing-sm);
            font-size: 0.9375rem;
        }

        .form-label-required::after {
            content: '*';
            color: var(--exprsn-danger);
            margin-left: var(--exprsn-spacing-xs);
        }

        .form-help {
            font-size: 0.875rem;
            color: var(--exprsn-text-secondary);
            margin-top: var(--exprsn-spacing-xs);
        }

        .form-input,
        .form-textarea,
        .form-select {
            width: 100%;
            padding: 0.75rem var(--exprsn-spacing-md);
            border: 1px solid var(--exprsn-border-color);
            border-radius: var(--exprsn-radius-lg);
            background: var(--exprsn-bg-primary);
            color: var(--exprsn-text-primary);
            font-size: 0.9375rem;
            font-family: var(--exprsn-font-family);
            transition: all var(--exprsn-transition-fast);
        }

        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--exprsn-primary);
            box-shadow: 0 0 0 3px rgba(0, 102, 255, 0.1);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-input-mono {
            font-family: var(--exprsn-font-family-mono);
            font-size: 0.875rem;
        }

        /* Checkbox Groups */
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: var(--exprsn-spacing-md);
        }

        .checkbox-item {
            display: flex;
            align-items: flex-start;
            gap: var(--exprsn-spacing-md);
            padding: var(--exprsn-spacing-md);
            border-radius: var(--exprsn-radius-lg);
            border: 1px solid var(--exprsn-border-color);
            cursor: pointer;
            transition: all var(--exprsn-transition-fast);
        }

        .checkbox-item:hover {
            background: var(--exprsn-bg-tertiary);
            border-color: var(--exprsn-primary);
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            margin-top: 2px;
        }

        .checkbox-content {
            flex: 1;
        }

        .checkbox-title {
            font-weight: 600;
            color: var(--exprsn-text-primary);
            margin-bottom: var(--exprsn-spacing-xs);
        }

        .checkbox-description {
            font-size: 0.875rem;
            color: var(--exprsn-text-secondary);
        }

        /* Button Group */
        .button-group {
            display: flex;
            gap: var(--exprsn-spacing-md);
            justify-content: flex-end;
            margin-top: var(--exprsn-spacing-xl);
            padding-top: var(--exprsn-spacing-xl);
            border-top: 1px solid var(--exprsn-border-color);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: var(--exprsn-radius-lg);
            font-weight: 600;
            font-size: 0.9375rem;
            cursor: pointer;
            transition: all var(--exprsn-transition-fast);
            border: none;
            display: inline-flex;
            align-items: center;
            gap: var(--exprsn-spacing-sm);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--exprsn-primary), var(--exprsn-secondary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--exprsn-shadow-lg);
        }

        .btn-secondary {
            background: var(--exprsn-bg-tertiary);
            color: var(--exprsn-text-primary);
        }

        .btn-secondary:hover {
            background: var(--exprsn-border-color);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Feature Cards */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--exprsn-spacing-lg);
            margin-top: var(--exprsn-spacing-lg);
        }

        .feature-card {
            background: var(--exprsn-bg-secondary);
            border-radius: var(--exprsn-radius-xl);
            padding: var(--exprsn-spacing-lg);
            border: 1px solid var(--exprsn-border-color);
            transition: all var(--exprsn-transition-fast);
        }

        .feature-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--exprsn-shadow-lg);
        }

        .feature-icon {
            width: 56px;
            height: 56px;
            border-radius: var(--exprsn-radius-lg);
            background: linear-gradient(135deg, rgba(0, 102, 255, 0.1), rgba(124, 58, 237, 0.1));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.75rem;
            color: var(--exprsn-primary);
            margin-bottom: var(--exprsn-spacing-md);
        }

        .feature-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--exprsn-text-primary);
            margin-bottom: var(--exprsn-spacing-sm);
        }

        .feature-description {
            font-size: 0.875rem;
            color: var(--exprsn-text-secondary);
            line-height: 1.6;
        }

        /* Code Preview */
        .code-preview {
            background: var(--exprsn-bg-primary);
            border: 1px solid var(--exprsn-border-color);
            border-radius: var(--exprsn-radius-lg);
            padding: var(--exprsn-spacing-md);
            font-family: var(--exprsn-font-family-mono);
            font-size: 0.875rem;
            overflow-x: auto;
            margin-top: var(--exprsn-spacing-md);
        }

        .code-preview pre {
            margin: 0;
            color: var(--exprsn-text-primary);
        }

        /* Alert */
        .alert {
            padding: var(--exprsn-spacing-md);
            border-radius: var(--exprsn-radius-lg);
            margin-bottom: var(--exprsn-spacing-lg);
            display: flex;
            align-items: flex-start;
            gap: var(--exprsn-spacing-md);
        }

        .alert-info {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid var(--exprsn-info);
            color: var(--exprsn-info);
        }

        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid var(--exprsn-success);
            color: var(--exprsn-success);
        }

        .alert-icon {
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        /* Progress Bar */
        .progress-bar {
            height: 4px;
            background: var(--exprsn-bg-tertiary);
            border-radius: var(--exprsn-radius-full);
            overflow: hidden;
            margin-bottom: var(--exprsn-spacing-xl);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--exprsn-primary), var(--exprsn-secondary));
            transition: width var(--exprsn-transition-slow);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="/lowcode/applications?version=v2" class="sidebar-brand">
                    <i class="bi bi-puzzle"></i>
                    <span>Plugin Creator</span>
                </a>
            </div>

            <div class="sidebar-content">
                <div class="step-nav" id="stepNav">
                    <div class="step-item active" data-step="1">
                        <div class="step-number">1</div>
                        <div class="step-info">
                            <div class="step-title">Basic Info</div>
                            <div class="step-description">Plugin metadata</div>
                        </div>
                    </div>
                    <div class="step-item" data-step="2">
                        <div class="step-number">2</div>
                        <div class="step-info">
                            <div class="step-title">Features</div>
                            <div class="step-description">Select capabilities</div>
                        </div>
                    </div>
                    <div class="step-item" data-step="3">
                        <div class="step-number">3</div>
                        <div class="step-info">
                            <div class="step-title">Routes</div>
                            <div class="step-description">API endpoints</div>
                        </div>
                    </div>
                    <div class="step-item" data-step="4">
                        <div class="step-number">4</div>
                        <div class="step-info">
                            <div class="step-title">Middleware</div>
                            <div class="step-description">Request handlers</div>
                        </div>
                    </div>
                    <div class="step-item" data-step="5">
                        <div class="step-number">5</div>
                        <div class="step-info">
                            <div class="step-title">Socket.IO</div>
                            <div class="step-description">Real-time events</div>
                        </div>
                    </div>
                    <div class="step-item" data-step="6">
                        <div class="step-number">6</div>
                        <div class="step-info">
                            <div class="step-title">Review</div>
                            <div class="step-description">Preview & generate</div>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Container -->
        <div class="main-container">
            <!-- Top Bar -->
            <div class="topbar">
                <div class="topbar-left">
                    <h1 class="topbar-title">Create New Plugin</h1>
                </div>
                <div class="topbar-right">
                    <button class="btn-theme" id="themeToggle" title="Toggle theme">
                        <i class="bi bi-moon-stars"></i>
                    </button>
                </div>
            </div>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Progress Bar -->
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 16.67%"></div>
                </div>

                <!-- Step 1: Basic Info -->
                <div class="wizard-step active" data-step="1">
                    <div class="step-header">
                        <h2 class="step-title-main">Basic Information</h2>
                        <p class="step-subtitle">Let's start with the essential details about your plugin</p>
                    </div>

                    <div class="form-section">
                        <div class="form-section-header">
                            <div class="section-icon">
                                <i class="bi bi-info-circle"></i>
                            </div>
                            <div>
                                <div class="section-title">Plugin Metadata</div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label form-label-required">Plugin Name</label>
                            <input type="text" class="form-input form-input-mono" id="pluginName" placeholder="my-awesome-plugin" required>
                            <div class="form-help">Use lowercase with hyphens. Will be used as the folder and module name.</div>
                        </div>

                        <div class="form-group">
                            <label class="form-label form-label-required">Display Name</label>
                            <input type="text" class="form-input" id="displayName" placeholder="My Awesome Plugin" required>
                            <div class="form-help">Human-readable name shown in the UI</div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <textarea class="form-textarea" id="description" placeholder="A brief description of what your plugin does..."></textarea>
                            <div class="form-help">Explain the purpose and functionality of your plugin</div>
                        </div>

                        <div class="form-group">
                            <label class="form-label form-label-required">Author</label>
                            <input type="text" class="form-input" id="author" placeholder="Your Name" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Author Email</label>
                            <input type="email" class="form-input" id="authorEmail" placeholder="you@example.com">
                        </div>

                        <div class="form-group">
                            <label class="form-label form-label-required">Version</label>
                            <input type="text" class="form-input form-input-mono" id="version" value="1.0.0" required>
                            <div class="form-help">Semantic versioning (MAJOR.MINOR.PATCH)</div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">License</label>
                            <select class="form-select" id="license">
                                <option value="MIT">MIT</option>
                                <option value="Apache-2.0">Apache 2.0</option>
                                <option value="GPL-3.0">GPL 3.0</option>
                                <option value="BSD-3-Clause">BSD 3-Clause</option>
                                <option value="ISC">ISC</option>
                                <option value="UNLICENSED">Unlicensed</option>
                            </select>
                        </div>
                    </div>

                    <div class="button-group">
                        <button class="btn btn-primary" onclick="nextStep()">
                            Next: Features <i class="bi bi-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 2: Features -->
                <div class="wizard-step" data-step="2">
                    <div class="step-header">
                        <h2 class="step-title-main">Plugin Features</h2>
                        <p class="step-subtitle">Select the capabilities your plugin will provide</p>
                    </div>

                    <div class="form-section">
                        <div class="form-section-header">
                            <div class="section-icon">
                                <i class="bi bi-cpu"></i>
                            </div>
                            <div>
                                <div class="section-title">Core Features</div>
                            </div>
                        </div>

                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" id="feature-routes" checked>
                                <div class="checkbox-content">
                                    <div class="checkbox-title">HTTP Routes</div>
                                    <div class="checkbox-description">Add custom Express routes and API endpoints</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="feature-middleware">
                                <div class="checkbox-content">
                                    <div class="checkbox-title">Custom Middleware</div>
                                    <div class="checkbox-description">Add request/response middleware functions</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="feature-socketio">
                                <div class="checkbox-content">
                                    <div class="checkbox-title">Socket.IO Handlers</div>
                                    <div class="checkbox-description">Add real-time WebSocket event handlers</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="feature-database">
                                <div class="checkbox-content">
                                    <div class="checkbox-title">Database Models</div>
                                    <div class="checkbox-description">Add Sequelize models and migrations</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="feature-views">
                                <div class="checkbox-content">
                                    <div class="checkbox-title">Custom Views</div>
                                    <div class="checkbox-description">Add EJS templates and UI pages</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="feature-static">
                                <div class="checkbox-content">
                                    <div class="checkbox-title">Static Assets</div>
                                    <div class="checkbox-description">Serve CSS, JavaScript, and image files</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="feature-hooks">
                                <div class="checkbox-content">
                                    <div class="checkbox-title">Lifecycle Hooks</div>
                                    <div class="checkbox-description">Hook into application lifecycle events</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="feature-settings">
                                <div class="checkbox-content">
                                    <div class="checkbox-title">Configuration UI</div>
                                    <div class="checkbox-description">Add settings page for plugin configuration</div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="prevStep()">
                            <i class="bi bi-arrow-left"></i> Back
                        </button>
                        <button class="btn btn-primary" onclick="nextStep()">
                            Next: Routes <i class="bi bi-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Additional steps will be added via JavaScript for dynamic content -->
                <div class="wizard-step" data-step="6">
                    <div class="step-header">
                        <h2 class="step-title-main">Review & Generate</h2>
                        <p class="step-subtitle">Review your plugin configuration and generate the code</p>
                    </div>

                    <div class="alert alert-info">
                        <i class="bi bi-info-circle alert-icon"></i>
                        <div>
                            Your plugin will be created in <strong>/src/exprsn-svr/plugins/[plugin-name]</strong>
                        </div>
                    </div>

                    <div class="form-section">
                        <div class="form-section-header">
                            <div class="section-icon">
                                <i class="bi bi-file-earmark-code"></i>
                            </div>
                            <div>
                                <div class="section-title">Plugin Summary</div>
                            </div>
                        </div>

                        <div id="reviewContent">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="prevStep()">
                            <i class="bi bi-arrow-left"></i> Back
                        </button>
                        <button class="btn btn-primary" onclick="generatePlugin()">
                            <i class="bi bi-lightning-charge"></i> Generate Plugin
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        // Application State
        const PluginCreator = {
            currentStep: 1,
            totalSteps: 6,
            data: {
                basic: {},
                features: {},
                routes: [],
                middleware: [],
                socketEvents: [],
                database: {},
                views: [],
                settings: {}
            },
            socket: null
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initializeTheme();
            initializeSocketIO();
            setupEventListeners();
            loadDraft();
        });

        // Theme Management
        function initializeTheme() {
            const savedTheme = localStorage.getItem('exprsn-theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeIcon(savedTheme);
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('exprsn-theme', newTheme);
            updateThemeIcon(newTheme);
        }

        function updateThemeIcon(theme) {
            const icon = document.querySelector('#themeToggle i');
            icon.className = theme === 'light' ? 'bi bi-moon-stars' : 'bi bi-sun';
        }

        // Socket.IO
        function initializeSocketIO() {
            PluginCreator.socket = io();

            PluginCreator.socket.on('connect', () => {
                console.log('Socket.IO connected');
            });

            PluginCreator.socket.on('plugin:generated', (data) => {
                console.log('Plugin generated:', data);
                showSuccess('Plugin generated successfully!', data.path);
            });

            PluginCreator.socket.on('plugin:error', (error) => {
                console.error('Plugin generation error:', error);
                showError('Failed to generate plugin', error.message);
            });
        }

        // Event Listeners
        function setupEventListeners() {
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);

            // Step navigation
            document.querySelectorAll('.step-item').forEach(item => {
                item.addEventListener('click', () => {
                    const step = parseInt(item.dataset.step);
                    if (step <= PluginCreator.currentStep) {
                        goToStep(step);
                    }
                });
            });

            // Auto-save draft
            setInterval(saveDraft, 30000); // Every 30 seconds
        }

        // Step Navigation
        function nextStep() {
            if (!validateCurrentStep()) return;

            saveStepData();

            if (PluginCreator.currentStep < PluginCreator.totalSteps) {
                goToStep(PluginCreator.currentStep + 1);
            }
        }

        function prevStep() {
            if (PluginCreator.currentStep > 1) {
                goToStep(PluginCreator.currentStep - 1);
            }
        }

        function goToStep(step) {
            // Hide current step
            document.querySelectorAll('.wizard-step').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.step-item').forEach(s => s.classList.remove('active'));

            // Show new step
            document.querySelector(`.wizard-step[data-step="${step}"]`).classList.add('active');
            document.querySelector(`.step-item[data-step="${step}"]`).classList.add('active');

            // Mark previous steps as completed
            document.querySelectorAll('.step-item').forEach(item => {
                const itemStep = parseInt(item.dataset.step);
                if (itemStep < step) {
                    item.classList.add('completed');
                } else {
                    item.classList.remove('completed');
                }
            });

            PluginCreator.currentStep = step;
            updateProgress();

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateProgress() {
            const progress = (PluginCreator.currentStep / PluginCreator.totalSteps) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
        }

        // Validation
        function validateCurrentStep() {
            switch (PluginCreator.currentStep) {
                case 1:
                    const name = document.getElementById('pluginName').value.trim();
                    const displayName = document.getElementById('displayName').value.trim();
                    const author = document.getElementById('author').value.trim();
                    const version = document.getElementById('version').value.trim();

                    if (!name || !displayName || !author || !version) {
                        showError('Validation Error', 'Please fill in all required fields');
                        return false;
                    }

                    if (!/^[a-z0-9-]+$/.test(name)) {
                        showError('Validation Error', 'Plugin name must use lowercase letters, numbers, and hyphens only');
                        return false;
                    }

                    if (!/^\d+\.\d+\.\d+$/.test(version)) {
                        showError('Validation Error', 'Version must follow semantic versioning (e.g., 1.0.0)');
                        return false;
                    }

                    return true;

                default:
                    return true;
            }
        }

        // Data Management
        function saveStepData() {
            switch (PluginCreator.currentStep) {
                case 1:
                    PluginCreator.data.basic = {
                        name: document.getElementById('pluginName').value.trim(),
                        displayName: document.getElementById('displayName').value.trim(),
                        description: document.getElementById('description').value.trim(),
                        author: document.getElementById('author').value.trim(),
                        authorEmail: document.getElementById('authorEmail').value.trim(),
                        version: document.getElementById('version').value.trim(),
                        license: document.getElementById('license').value
                    };
                    break;

                case 2:
                    PluginCreator.data.features = {
                        routes: document.getElementById('feature-routes').checked,
                        middleware: document.getElementById('feature-middleware').checked,
                        socketio: document.getElementById('feature-socketio').checked,
                        database: document.getElementById('feature-database').checked,
                        views: document.getElementById('feature-views').checked,
                        static: document.getElementById('feature-static').checked,
                        hooks: document.getElementById('feature-hooks').checked,
                        settings: document.getElementById('feature-settings').checked
                    };
                    break;
            }

            saveDraft();
        }

        function saveDraft() {
            localStorage.setItem('plugin-creator-draft', JSON.stringify(PluginCreator.data));
        }

        function loadDraft() {
            const draft = localStorage.getItem('plugin-creator-draft');
            if (draft) {
                try {
                    PluginCreator.data = JSON.parse(draft);
                    populateFormFromDraft();
                } catch (e) {
                    console.error('Failed to load draft:', e);
                }
            }
        }

        function populateFormFromDraft() {
            const basic = PluginCreator.data.basic;
            if (basic) {
                if (basic.name) document.getElementById('pluginName').value = basic.name;
                if (basic.displayName) document.getElementById('displayName').value = basic.displayName;
                if (basic.description) document.getElementById('description').value = basic.description;
                if (basic.author) document.getElementById('author').value = basic.author;
                if (basic.authorEmail) document.getElementById('authorEmail').value = basic.authorEmail;
                if (basic.version) document.getElementById('version').value = basic.version;
                if (basic.license) document.getElementById('license').value = basic.license;
            }
        }

        // Plugin Generation
        async function generatePlugin() {
            saveStepData();

            try {
                const response = await fetch('/lowcode/api/plugins/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(PluginCreator.data)
                });

                const result = await response.json();

                if (result.success) {
                    showSuccess('Plugin Generated!', `Your plugin has been created at: ${result.path}`);
                    localStorage.removeItem('plugin-creator-draft');

                    setTimeout(() => {
                        window.location.href = '/lowcode/plugins';
                    }, 3000);
                } else {
                    showError('Generation Failed', result.message);
                }
            } catch (error) {
                showError('Generation Failed', error.message);
            }
        }

        // Notifications
        function showSuccess(title, message) {
            alert(`${title}\n\n${message}`);
        }

        function showError(title, message) {
            alert(`‚ùå ${title}\n\n${message}`);
        }
    </script>
</body>
</html>
