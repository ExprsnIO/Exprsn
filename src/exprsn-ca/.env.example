# Exprsn Certificate Authority - Environment Configuration

# =============================================================================
# Server Configuration
# =============================================================================

# Node environment (development, staging, production)
NODE_ENV=development

# Server port and host
PORT=3000
HOST=0.0.0.0

# Cluster mode (for high availability)
CLUSTER_ENABLED=false
CLUSTER_WORKERS=4

# =============================================================================
# Database Configuration
# =============================================================================

# PostgreSQL connection settings
DB_HOST=localhost
DB_PORT=5432
DB_NAME=exprsn_ca
DB_USER=exprsn_ca_user
DB_PASSWORD=your_password_here

# SSL/TLS for database connections
DB_SSL=false

# Connection pool settings
DB_POOL_MIN=5
DB_POOL_MAX=20

# =============================================================================
# TLS/HTTPS Configuration
# =============================================================================

# Enable TLS/HTTPS
TLS_ENABLED=true
TLS_CERT_PATH=./certs/localhost-cert.pem
TLS_KEY_PATH=./certs/localhost-key.pem

# =============================================================================
# Security Configuration
# =============================================================================

# Private key encryption (32-byte hex key)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ENCRYPTION_KEY=

# CORS allowed origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:5000,http://localhost:3001

# =============================================================================
# Redis Cache Configuration
# =============================================================================

# Enable Redis caching
REDIS_ENABLED=true
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_KEY_PREFIX=exprsn:ca:

# Cache TTL (time-to-live) in seconds
CACHE_TOKEN_TTL=60
CACHE_CERT_TTL=300
CACHE_OCSP_TTL=300

# =============================================================================
# Certificate Authority Configuration
# =============================================================================

# CA Identity
CA_NAME=Exprsn Root CA
CA_DOMAIN=ca.exprsn.io
CA_COUNTRY=US
CA_STATE=California
CA_LOCALITY=San Francisco
CA_ORGANIZATION=Exprsn IO
CA_ORGANIZATIONAL_UNIT=Certificate Authority
CA_EMAIL=ca@exprsn.io

# Certificate validity periods (days)
CA_ROOT_VALIDITY_DAYS=7300
CA_INTERMEDIATE_VALIDITY_DAYS=3650
CA_ENTITY_VALIDITY_DAYS=365

# RSA key sizes (bits)
CA_ROOT_KEY_SIZE=4096
CA_INTERMEDIATE_KEY_SIZE=4096
CA_ENTITY_KEY_SIZE=2048

# =============================================================================
# Session Configuration
# =============================================================================

# Session secret (CRITICAL: Generate a strong secret for production)
SESSION_SECRET=exprsn-ca-secret-change-me

# Session max age (milliseconds)
SESSION_MAX_AGE=86400000

# Cookie settings
SESSION_SECURE=false
SESSION_SAME_SITE=lax

# =============================================================================
# JWT Configuration
# =============================================================================

# JWT keys (base64-encoded PEM format)
# Generate with: openssl genrsa 2048 | base64 -w 0
JWT_PRIVATE_KEY=
JWT_PUBLIC_KEY=

# JWT settings
JWT_ISSUER=exprsn-ca
JWT_ALGORITHM=RS256
JWT_ACCESS_TOKEN_EXPIRY=3600
JWT_REFRESH_TOKEN_EXPIRY=2592000

# =============================================================================
# OCSP Configuration
# =============================================================================

# Enable OCSP responder
OCSP_ENABLED=true
OCSP_PORT=2560
OCSP_URL=http://ocsp.exprsn.io:2560

# Batch OCSP requests
OCSP_BATCH_ENABLED=false
OCSP_BATCH_TIMEOUT=100

# OCSP caching
OCSP_CACHE_ENABLED=true
OCSP_CACHE_TTL=300

# =============================================================================
# CRL Configuration
# =============================================================================

# Enable CRL generation
CRL_ENABLED=true

# =============================================================================
# Storage Configuration
# =============================================================================

# Storage type (disk, s3, postgresql)
STORAGE_TYPE=disk
STORAGE_PATH=./storage

# S3 configuration (if STORAGE_TYPE=s3)
S3_BUCKET=
S3_REGION=
S3_ACCESS_KEY=
S3_SECRET_KEY=

# =============================================================================
# Logging Configuration
# =============================================================================

# Log level (error, warn, info, debug)
LOG_LEVEL=info

# =============================================================================
# Production Configuration
# =============================================================================

# CRITICAL: In production:
# - Set NODE_ENV=production
# - Generate secure SESSION_SECRET
# - Generate and configure JWT keys
# - Enable HTTPS with SESSION_SECURE=true
# - Configure proper database credentials
# - Enable Redis caching
# - Configure OCSP and CRL distribution points
# - Set appropriate log level
