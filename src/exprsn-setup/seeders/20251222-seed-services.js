/**
 * Seed all 18 Exprsn services into the ServiceConfiguration table
 */

module.exports = {
  up: async (queryInterface, Sequelize) => {
    const services = [
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'ca',
        service_name: 'Certificate Authority',
        version: '1.0.0',
        port: 3000,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_ca',
        redis_enabled: true,
        redis_prefix: 'ca:',
        dependencies: [],
        description: 'X.509 Certificate Authority with OCSP and CRL support',
        health_check_url: 'http://localhost:3000/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'auth',
        service_name: 'Authentication & SSO',
        version: '1.0.0',
        port: 3001,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_auth',
        redis_enabled: true,
        redis_prefix: 'auth:',
        dependencies: ['ca'],
        description: 'OAuth2/OIDC provider with SAML SSO and MFA support',
        health_check_url: 'http://localhost:3001/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'spark',
        service_name: 'Real-time Messaging',
        version: '1.0.0',
        port: 3002,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_spark',
        redis_enabled: true,
        redis_prefix: 'spark:',
        dependencies: ['ca', 'auth'],
        description: 'Real-time messaging with E2EE support',
        health_check_url: 'http://localhost:3002/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'timeline',
        service_name: 'Social Timeline',
        version: '1.0.0',
        port: 3004,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_timeline',
        redis_enabled: true,
        redis_prefix: 'timeline:',
        dependencies: ['ca', 'auth'],
        description: 'Social timeline with Bull queue processing',
        health_check_url: 'http://localhost:3004/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'prefetch',
        service_name: 'Timeline Prefetching',
        version: '1.0.0',
        port: 3005,
        enabled: true,
        status: 'not_configured',
        database_enabled: false,
        redis_enabled: true,
        redis_prefix: 'prefetch:',
        dependencies: ['timeline'],
        description: 'Timeline caching and prefetching service',
        health_check_url: 'http://localhost:3005/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'moderator',
        service_name: 'Content Moderation',
        version: '1.0.0',
        port: 3006,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_moderator',
        redis_enabled: true,
        redis_prefix: 'moderator:',
        dependencies: ['ca', 'auth'],
        description: 'AI-powered content moderation',
        health_check_url: 'http://localhost:3006/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'filevault',
        service_name: 'File Storage',
        version: '1.0.0',
        port: 3007,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_filevault',
        redis_enabled: true,
        redis_prefix: 'filevault:',
        dependencies: ['ca', 'auth'],
        description: 'File storage with S3/Disk/IPFS backends',
        health_check_url: 'http://localhost:3007/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'gallery',
        service_name: 'Media Galleries',
        version: '1.0.0',
        port: 3008,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_gallery',
        redis_enabled: true,
        redis_prefix: 'gallery:',
        dependencies: ['ca', 'auth', 'filevault'],
        description: 'Media galleries with AI tagging',
        health_check_url: 'http://localhost:3008/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'live',
        service_name: 'Live Streaming',
        version: '1.0.0',
        port: 3009,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_live',
        redis_enabled: true,
        redis_prefix: 'live:',
        dependencies: ['ca', 'auth'],
        description: 'Live streaming with WebRTC signaling',
        health_check_url: 'http://localhost:3009/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'bridge',
        service_name: 'API Gateway',
        version: '1.0.0',
        port: 3010,
        enabled: true,
        status: 'not_configured',
        database_enabled: false,
        redis_enabled: true,
        redis_prefix: 'bridge:',
        dependencies: ['ca'],
        description: 'API gateway with rate limiting',
        health_check_url: 'http://localhost:3010/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'nexus',
        service_name: 'Groups & Events',
        version: '1.0.0',
        port: 3011,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_nexus',
        redis_enabled: true,
        redis_prefix: 'nexus:',
        dependencies: ['ca', 'auth'],
        description: 'Groups, events, CalDAV/CardDAV',
        health_check_url: 'http://localhost:3011/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'pulse',
        service_name: 'Analytics & Metrics',
        version: '1.0.0',
        port: 3012,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_pulse',
        redis_enabled: true,
        redis_prefix: 'pulse:',
        dependencies: ['ca', 'auth'],
        description: 'Analytics and metrics collection',
        health_check_url: 'http://localhost:3012/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'vault',
        service_name: 'Secrets Management',
        version: '1.0.0',
        port: 3013,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_vault',
        redis_enabled: true,
        redis_prefix: 'vault:',
        dependencies: ['ca', 'auth'],
        description: 'Secrets management with encryption',
        health_check_url: 'http://localhost:3013/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'herald',
        service_name: 'Notifications & Alerts',
        version: '1.0.0',
        port: 3014,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_herald',
        redis_enabled: true,
        redis_prefix: 'herald:',
        dependencies: ['ca', 'auth'],
        description: 'Multi-channel notification delivery',
        health_check_url: 'http://localhost:3014/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'setup',
        service_name: 'Setup & Management',
        version: '1.0.0',
        port: 3015,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_setup',
        redis_enabled: true,
        redis_prefix: 'setup:',
        dependencies: [],
        description: 'Service discovery and health monitoring',
        health_check_url: 'http://localhost:3015/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'forge',
        service_name: 'Business Platform',
        version: '1.0.0',
        port: 3016,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_forge',
        redis_enabled: true,
        redis_prefix: 'forge:',
        dependencies: ['ca', 'auth'],
        description: 'CRM, Groupware, and ERP modules',
        health_check_url: 'http://localhost:3016/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'workflow',
        service_name: 'Workflow Automation',
        version: '1.0.0',
        port: 3017,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_workflow',
        redis_enabled: true,
        redis_prefix: 'workflow:',
        dependencies: ['ca', 'auth'],
        description: 'Visual workflow automation',
        health_check_url: 'http://localhost:3017/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: Sequelize.literal('gen_random_uuid()'),
        service_id: 'svr',
        service_name: 'Dynamic Page Server',
        version: '1.0.0',
        port: 5000,
        enabled: true,
        status: 'not_configured',
        database_enabled: true,
        database_name: 'exprsn_svr',
        redis_enabled: true,
        redis_prefix: 'svr:',
        dependencies: ['ca', 'auth'],
        description: 'Dynamic page server with Low-Code Platform',
        health_check_url: 'http://localhost:5000/health',
        health_check_interval: 30000,
        created_at: new Date(),
        updated_at: new Date()
      }
    ];

    await queryInterface.bulkInsert('service_configurations', services);
  },

  down: async (queryInterface) => {
    await queryInterface.bulkDelete('service_configurations', null, {});
  }
};
