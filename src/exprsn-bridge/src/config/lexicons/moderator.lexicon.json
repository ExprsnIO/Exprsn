{
  "lexicon": {
    "version": "1.0",
    "service": {
      "name": "exprsn-moderator",
      "version": "1.0.0",
      "description": "Content Moderation Service"
    },
    "routes": [
      {
        "path": "/api/moderator/submit",
        "method": "POST",
        "description": "Submit content for moderation",
        "target": {
          "service": "moderator",
          "path": "/api/moderator/submit",
          "timeout": 5000
        },
        "auth": {
          "required": true,
          "permissions": {
            "write": true
          },
          "certificateBinding": false
        },
        "validation": {
          "body": {
            "type": "object",
            "required": ["contentType", "contentId", "content"],
            "properties": {
              "contentType": {
                "type": "string",
                "enum": ["post", "comment", "profile", "message", "media"]
              },
              "contentId": {
                "type": "string",
                "format": "uuid"
              },
              "content": {
                "type": "string",
                "minLength": 1,
                "maxLength": 10000
              },
              "authorId": {
                "type": "string",
                "format": "uuid"
              },
              "metadata": {
                "type": "object"
              },
              "priority": {
                "type": "string",
                "enum": ["low", "normal", "high", "urgent"],
                "default": "normal"
              }
            }
          }
        },
        "rateLimit": {
          "windowMs": 60000,
          "max": 100
        }
      },
      {
        "path": "/api/moderator/queue",
        "method": "GET",
        "description": "Get moderation queue",
        "target": {
          "service": "moderator",
          "path": "/api/moderator/queue",
          "timeout": 5000
        },
        "auth": {
          "required": true,
          "permissions": {
            "read": true
          }
        },
        "validation": {
          "query": {
            "status": {
              "type": "string",
              "enum": ["pending", "approved", "rejected", "escalated"]
            },
            "priority": {
              "type": "string",
              "enum": ["low", "normal", "high", "urgent"]
            },
            "page": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            },
            "limit": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20
            }
          }
        },
        "rateLimit": {
          "windowMs": 60000,
          "max": 60
        }
      },
      {
        "path": "/api/moderator/items/:id",
        "method": "GET",
        "description": "Get moderation item details",
        "target": {
          "service": "moderator",
          "path": "/api/moderator/items/:id",
          "timeout": 3000
        },
        "auth": {
          "required": true,
          "permissions": {
            "read": true
          }
        },
        "validation": {
          "params": {
            "id": {
              "type": "string",
              "format": "uuid"
            }
          }
        },
        "rateLimit": {
          "windowMs": 60000,
          "max": 100
        }
      },
      {
        "path": "/api/moderator/action",
        "method": "POST",
        "description": "Execute moderation action",
        "target": {
          "service": "moderator",
          "path": "/api/moderator/action",
          "timeout": 5000
        },
        "auth": {
          "required": true,
          "permissions": {
            "write": true
          }
        },
        "validation": {
          "body": {
            "type": "object",
            "required": ["itemId", "action"],
            "properties": {
              "itemId": {
                "type": "string",
                "format": "uuid"
              },
              "action": {
                "type": "string",
                "enum": ["approve", "reject", "remove", "flag", "warn", "suspend", "ban", "escalate"]
              },
              "reason": {
                "type": "string",
                "minLength": 1,
                "maxLength": 1000
              },
              "duration": {
                "type": "integer",
                "minimum": 1
              },
              "notes": {
                "type": "string",
                "maxLength": 2000
              }
            }
          }
        },
        "rateLimit": {
          "windowMs": 60000,
          "max": 50
        }
      },
      {
        "path": "/api/moderator/actions/remove",
        "method": "POST",
        "description": "Remove content",
        "target": {
          "service": "moderator",
          "path": "/api/moderator/actions/remove",
          "timeout": 5000
        },
        "auth": {
          "required": true,
          "permissions": {
            "delete": true
          }
        },
        "validation": {
          "body": {
            "type": "object",
            "required": ["contentId", "contentType", "reason"],
            "properties": {
              "contentId": {
                "type": "string",
                "format": "uuid"
              },
              "contentType": {
                "type": "string",
                "enum": ["post", "comment", "profile", "message", "media"]
              },
              "reason": {
                "type": "string",
                "minLength": 1,
                "maxLength": 1000
              },
              "notifyUser": {
                "type": "boolean",
                "default": true
              }
            }
          }
        },
        "rateLimit": {
          "windowMs": 60000,
          "max": 30
        }
      },
      {
        "path": "/api/moderator/actions/flag",
        "method": "POST",
        "description": "Flag content for review",
        "target": {
          "service": "moderator",
          "path": "/api/moderator/actions/flag",
          "timeout": 3000
        },
        "auth": {
          "required": true,
          "permissions": {
            "write": true
          }
        },
        "validation": {
          "body": {
            "type": "object",
            "required": ["contentId", "contentType", "flagType"],
            "properties": {
              "contentId": {
                "type": "string",
                "format": "uuid"
              },
              "contentType": {
                "type": "string",
                "enum": ["post", "comment", "profile", "message", "media"]
              },
              "flagType": {
                "type": "string",
                "enum": ["spam", "abuse", "harassment", "hate_speech", "violence", "nsfw", "misinformation", "other"]
              },
              "description": {
                "type": "string",
                "maxLength": 1000
              }
            }
          }
        },
        "rateLimit": {
          "windowMs": 60000,
          "max": 50
        }
      },
      {
        "path": "/api/moderator/actions/warn",
        "method": "POST",
        "description": "Issue warning to user",
        "target": {
          "service": "moderator",
          "path": "/api/moderator/actions/warn",
          "timeout": 5000
        },
        "auth": {
          "required": true,
          "permissions": {
            "write": true
          }
        },
        "validation": {
          "body": {
            "type": "object",
            "required": ["userId", "reason"],
            "properties": {
              "userId": {
                "type": "string",
                "format": "uuid"
              },
              "reason": {
                "type": "string",
                "minLength": 1,
                "maxLength": 1000
              },
              "severity": {
                "type": "string",
                "enum": ["low", "medium", "high"],
                "default": "medium"
              },
              "message": {
                "type": "string",
                "maxLength": 2000
              }
            }
          }
        },
        "rateLimit": {
          "windowMs": 60000,
          "max": 20
        }
      },
      {
        "path": "/api/moderator/actions/suspend",
        "method": "POST",
        "description": "Suspend user account",
        "target": {
          "service": "moderator",
          "path": "/api/moderator/actions/suspend",
          "timeout": 5000
        },
        "auth": {
          "required": true,
          "permissions": {
            "write": true
          }
        },
        "validation": {
          "body": {
            "type": "object",
            "required": ["userId", "reason", "duration"],
            "properties": {
              "userId": {
                "type": "string",
                "format": "uuid"
              },
              "reason": {
                "type": "string",
                "minLength": 1,
                "maxLength": 1000
              },
              "duration": {
                "type": "integer",
                "minimum": 1,
                "maximum": 365
              },
              "message": {
                "type": "string",
                "maxLength": 2000
              }
            }
          }
        },
        "rateLimit": {
          "windowMs": 60000,
          "max": 10
        }
      },
      {
        "path": "/api/moderator/actions/ban",
        "method": "POST",
        "description": "Permanently ban user account",
        "target": {
          "service": "moderator",
          "path": "/api/moderator/actions/ban",
          "timeout": 5000
        },
        "auth": {
          "required": true,
          "permissions": {
            "delete": true
          }
        },
        "validation": {
          "body": {
            "type": "object",
            "required": ["userId", "reason"],
            "properties": {
              "userId": {
                "type": "string",
                "format": "uuid"
              },
              "reason": {
                "type": "string",
                "minLength": 1,
                "maxLength": 1000
              },
              "deleteContent": {
                "type": "boolean",
                "default": false
              },
              "message": {
                "type": "string",
                "maxLength": 2000
              }
            }
          }
        },
        "rateLimit": {
          "windowMs": 60000,
          "max": 5
        }
      },
      {
        "path": "/api/moderator/user/:userId/actions",
        "method": "GET",
        "description": "Get user moderation action history",
        "target": {
          "service": "moderator",
          "path": "/api/moderator/user/:userId/actions",
          "timeout": 5000
        },
        "auth": {
          "required": true,
          "permissions": {
            "read": true
          }
        },
        "validation": {
          "params": {
            "userId": {
              "type": "string",
              "format": "uuid"
            }
          },
          "query": {
            "page": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            },
            "limit": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20
            }
          }
        },
        "rateLimit": {
          "windowMs": 60000,
          "max": 60
        }
      }
    ],
    "policies": {
      "defaultAuth": true,
      "defaultRateLimit": {
        "windowMs": 900000,
        "max": 2000
      },
      "cors": {
        "origin": "*",
        "credentials": true
      }
    }
  }
}
